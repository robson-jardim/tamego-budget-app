<mat-table
    [dataSource]="dataSource"
    [trackBy]="trackCategories"
    #table>

    <mat-header-row *matHeaderRowDef="columns" class="table-column-header"></mat-header-row>

    <mat-row *matRowDef="let row; columns: columns;"
             [ngClass]="{'table-row-hovered': hoveredTableRow == row.categoryId}"
             (mouseenter)="highlight(row)"
             (mouseleave)="unhighlight(row)"
             (click)="updateCategory(row)">
    </mat-row>

    <ng-container matColumnDef="categoryName">
        <mat-header-cell *matHeaderCellDef> Category</mat-header-cell>
        <mat-cell *matCellDef="let element">{{element.categoryName}}</mat-cell>
    </ng-container>

    <ng-container matColumnDef="budgeted">
        <mat-header-cell *matHeaderCellDef>Budgeted</mat-header-cell>
        <mat-cell *matCellDef="let element">
            <span [ngClass]="{
                'font-red':element.desiredValue.budgeted < 0,
                'font-green' : element.desiredValue.budgeted > 0
            }">$ {{element.desiredValue.budgeted}}</span>
        </mat-cell>
    </ng-container>

    <ng-container matColumnDef="activity">
        <mat-header-cell *matHeaderCellDef>Activity</mat-header-cell>
        <mat-cell *matCellDef="let element">
            <span [ngClass]="{
                'font-red': element.activity < 0, 'font-green' : element.activity > 0
            }">
                $ {{element.activity}}
            </span>
        </mat-cell>
    </ng-container>

    <ng-container matColumnDef="available">
        <mat-header-cell *matHeaderCellDef>Available</mat-header-cell>
        <mat-cell *matCellDef="let element">
            <span [ngClass]="{
                'font-red':element.budgetedTotalToDate + element.activity + element.pastActivityTotal < 0,
                'font-green' : element.budgetedTotalToDate + element.activity + element.pastActivityTotal > 0
            }">
                 $ {{element.budgetedTotalToDate + element.activity + element.pastActivityTotal}}
            </span>
        </mat-cell>
    </ng-container>

    <ng-container matColumnDef="actions">
        <mat-header-cell *matHeaderCellDef></mat-header-cell>
        <mat-cell *matCellDef="let element">

            <button mat-icon-button [matMenuTriggerFor]="options" (click)="$event.stopPropagation()">
                <mat-icon>more_vert</mat-icon>
            </button>
            <mat-menu #options>
                <button mat-menu-item (click)="updateCategory(element)">Edit</button>
            </mat-menu>

        </mat-cell>
    </ng-container>
</mat-table>
